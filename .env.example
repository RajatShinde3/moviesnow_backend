# MoviesNow Backend â€” Example Environment (safe to commit)

# Copy to `.env` for local development and fill in secrets.
# Do NOT commit real secrets. In production use a secret manager or CI/CD
# environment variables, not a .env file.

# ==== Postgres ====
POSTGRES_SERVER=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=changeme
POSTGRES_DB=moviesnow

# ==== Redis ====
REDIS_URL=redis://localhost:6379/0

# ==== URLs / Frontend (restrict to your real frontend origin in prod) ====
FRONTEND_URL=http://localhost:8000
FRONTEND_ORIGINS=http://localhost:3000,http://127.0.0.1:3000,http://localhost:5173,http://127.0.0.1:5173
# ALLOW_ORIGINS_REGEX can be used instead of FRONTEND_ORIGINS, leave empty unless needed
ALLOW_ORIGINS_REGEX=

# ==== SMTP / Email (dev) ====
SMTP_HOST=
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
EMAIL_FROM="MoviesNow <noreply@example.com>"
EMAIL_STRICT_LOCAL=1
EMAIL_VERIFY_BASE_URL=http://localhost:8000

# ==== JWT / Secrets (REQUIRED) ====
# Generate a strong random value for local dev: `openssl rand -hex 32`
JWT_SECRET_KEY=please_set_a_secure_random_value
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7

# ==== Rate Limiting ====
RATE_LIMIT_ENABLED=true
DEFAULT_RATE_LIMIT=200/minute
RATELIMIT_STORAGE_URI=memory://
RATE_LIMIT_TRUSTED_IPS=127.0.0.1,::1
RATE_LIMIT_SKIP_PATHS=/health,/metrics,/docs,/openapi.json,/static/,/favicon.ico

# ==== Environment toggles ====
ENV=development
ENABLE_HTTPS_REDIRECT=false

# ==== CSP / Security Headers (dev-relaxed) ====
CSP_DEFAULT_SRC='self'
CSP_SCRIPT_SRC='self' 'unsafe-inline' 'unsafe-eval' 'strict-dynamic'
CSP_STYLE_SRC='self' 'unsafe-inline'
CSP_IMG_SRC='self' data: blob:
CSP_FONT_SRC='self' data:
CSP_CONNECT_SRC='self' http://localhost:3000 http://127.0.0.1:3000 http://localhost:5173 http://127.0.0.1:5173 ws://localhost:3000 ws://127.0.0.1:3000 ws://localhost:5173 ws://127.0.0.1:5173
CSP_FRAME_ANCESTORS='none'

HSTS_MAX_AGE=0
HSTS_INCLUDE_SUBDOMAINS=false
HSTS_PRELOAD=false

REFERRER_POLICY=strict-origin-when-cross-origin
PERMISSIONS_POLICY=accelerometer=(), autoplay=(), camera=(), display-capture=(), geolocation=(), gyroscope=(), microphone=(), payment=(), usb=()
CROSS_ORIGIN_OPENER_POLICY=same-origin
CROSS_ORIGIN_RESOURCE_POLICY=same-origin
CROSS_ORIGIN_EMBEDDER_POLICY=unsafe-none
SECURITY_SKIP_PATHS=/health,/metrics,/docs,/openapi.json,/static/

# ==== Storage / CDN (optional in dev) ====
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1
AWS_BUCKET_NAME=
CLOUDFRONT_DOMAIN=

# Optional S3 endpoint for LocalStack or custom S3-compatible storage
# AWS_S3_ENDPOINT_URL=http://localhost:4566

# Optional server-side encryption settings
# AWS_SSE_MODE=AES256            # or aws:kms
# AWS_KMS_KEY_ID=arn:aws:kms:us-east-1:123456789012:key/abcd-efgh

# ==== Optional observability ====
SENTRY_DSN=
